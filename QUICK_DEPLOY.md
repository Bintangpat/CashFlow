# üöÄ Quick Deployment Checklist

## Railway Backend Setup

### 1Ô∏è‚É£ Get Railway URL
After your Railway deployment is done, copy your service URL:
```
https://your-service-name.up.railway.app
```

### 2Ô∏è‚É£ Set Environment Variables in Railway
Go to Railway Dashboard ‚Üí Your Service ‚Üí **Variables** tab:

```env
NODE_ENV=production
JWT_SECRET=<generate-strong-secret-32-chars>
JWT_EXPIRES_IN=7d
RESEND_API_KEY=<your-resend-key>
EMAIL_FROM=CashFlow <noreply@yourdomain.com>
FRONTEND_URL=https://your-app.vercel.app
```

> **Important**: You'll update `FRONTEND_URL` after Vercel deployment!

### 3Ô∏è‚É£ Run Database Migrations
```bash
# Option 1: Using Railway CLI
railway login
railway link
railway run pnpm --filter @cashflow/api prisma migrate deploy

# Option 2: Add to Railway build command temporarily
# Build Command: pnpm install --frozen-lockfile && pnpm --filter @cashflow/api prisma migrate deploy && pnpm --filter @cashflow/api build
```

---

## Vercel Frontend Setup

### 1Ô∏è‚É£ Deploy to Vercel
1. Go to [vercel.com](https://vercel.com) ‚Üí Import Project
2. Select your GitHub repository
3. **Root Directory**: `apps/web`
4. **Framework**: Next.js
5. Click **Deploy** (first deployment may fail - that's OK!)

### 2Ô∏è‚É£ Copy Your Vercel URL
After deployment, copy your Vercel URL:
```
https://your-app.vercel.app
```

### 3Ô∏è‚É£ Set Environment Variables in Vercel
Go to Vercel ‚Üí Your Project ‚Üí **Settings** ‚Üí **Environment Variables**:

```env
NEXT_PUBLIC_API_URL=https://your-railway-url.up.railway.app/api
NEXTAUTH_URL=https://your-app.vercel.app
NEXTAUTH_SECRET=<generate-strong-secret-32-chars>
```

> Replace `your-railway-url` with your actual Railway URL from Step 1!

### 4Ô∏è‚É£ Redeploy Vercel
After adding environment variables:
- Go to **Deployments** tab
- Click **...** on latest deployment ‚Üí **Redeploy**

---

## Connect Railway with Vercel

### 1Ô∏è‚É£ Update Railway FRONTEND_URL
1. Go to Railway ‚Üí Your Service ‚Üí **Variables**
2. Update `FRONTEND_URL` to your Vercel URL: `https://your-app.vercel.app`
3. Railway will auto-redeploy with new CORS settings

---

## ‚úÖ Verify Everything Works

### Backend Health Check
Visit: `https://your-railway-url.up.railway.app/`

Should show:
```json
{
  "status": "OK",
  "message": "CashFlow API is running",
  "timestamp": "2026-01-14T16:43:16.000Z",
  "environment": "production"
}
```

### Frontend Check
1. Visit: `https://your-app.vercel.app`
2. Open Browser DevTools ‚Üí Console
3. Try to register/login
4. Should NOT see CORS errors
5. API calls should work!

---

## üîê Generate Strong Secrets

### For JWT_SECRET and NEXTAUTH_SECRET:
```bash
# Method 1: OpenSSL
openssl rand -base64 32

# Method 2: Node.js
node -e "console.log(require('crypto').randomBytes(32).toString('base64'))"

# Method 3: Online
# Visit: https://generate-secret.vercel.app/32
```

---

## üêõ Troubleshooting

### CORS Error?
‚úÖ Check `FRONTEND_URL` in Railway matches Vercel URL exactly (no trailing slash)
‚úÖ Redeploy Railway after updating FRONTEND_URL

### API Not Loading?
‚úÖ Check `NEXT_PUBLIC_API_URL` in Vercel includes `/api` at the end
‚úÖ Verify Railway service is running (check health endpoint)

### Database Connection Error?
‚úÖ Ensure Railway PostgreSQL service is running
‚úÖ Run migrations: `railway run pnpm --filter @cashflow/api prisma migrate deploy`

### Environment Variables Not Loading?
‚úÖ Redeploy after adding new environment variables
‚úÖ Check variable names are EXACTLY as shown (case-sensitive!)

---

## üìù Summary

**Railway Environment Variables:**
- `NODE_ENV=production`
- `DATABASE_URL` (auto-generated by Railway PostgreSQL)
- `JWT_SECRET` (generate strong secret)
- `JWT_EXPIRES_IN=7d`
- `RESEND_API_KEY` (from resend.com)
- `EMAIL_FROM` (your email)
- `FRONTEND_URL` (your Vercel URL)

**Vercel Environment Variables:**
- `NEXT_PUBLIC_API_URL` (your Railway URL + `/api`)
- `NEXTAUTH_URL` (your Vercel URL)
- `NEXTAUTH_SECRET` (generate strong secret)

---

**Need More Help?** Check `DEPLOYMENT.md` for detailed instructions!
